syntax="proto3";

option go_package = "./genproto/notificationpb";

service NotificationService {
  rpc SendNotification (SendNotificationRequest) returns (SendNotificationResponse);
}

enum SenderType {
  SENDER_UNKNOWN = 0;
  SENDER_ADMIN = 1;
  SENDER_ORGANIZER = 2;
}

enum NotificationType {
  SYSTEM = 0;
  SCORE_UPDATE = 1;
  TEAM_INVITE = 2;
  EVENT_UPDATE = 3;
  GENERAL = 4; // oddiy e’lonlar uchun
}

message Notification {
  string id = 1;
  string sender_id = 2;
  SenderType sender_type = 3;
  string user_id = 4;
  bool is_public = 5;
  string title = 6;
  string body = 7;
  NotificationType type = 8;
  string created_at = 9;   // ISO format: 2025-11-18T17:45:00Z
}

message SendNotificationRequest {
  string sender_id = 1;          // Kim yubordi (admin yoki organizer user_id)
  SenderType sender_type = 2;    // ADMIN yoki ORGANIZER
  string user_id = 3;            // Agar individual bo‘lsa — bitta foydalanuvchi ID
  bool is_public = 4;            // True bo‘lsa — barchaga yuboriladi (public)
  string title = 5;              // Xabar sarlavhasi
  string body = 6;               // Xabar matni
  NotificationType type = 7;     // SCORE_UPDATE, TEAM_INVITE, SYSTEM va h.k.
}

message SendNotificationResponse {
  Notification notification = 1;
}
