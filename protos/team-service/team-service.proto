syntax = "proto3";

option go_package = "./genproto/teampb";

// ================= SERVICE =================

service TeamService {
    // --- Team CRUD ---
    rpc CreateTeam (CreateTeamRequest) returns (Team);
    rpc UpdateTeam (UpdateTeamRequest) returns (Team);
    rpc GetTeamsByEvent (GetTeamsByEventRequest) returns (TeamList);
    rpc RemoveTeamMember (RemoveTeamMemberRequest) returns (StatusResponse);
  
    // --- Membership & Invitations ---
    rpc InviteMember (InviteMemberRequest) returns (StatusResponse);
    rpc RespondInvite (RespondInviteRequest) returns (StatusResponse);

    rpc GetTeamMembers (GetTeamRequest) returns (MemberList);
  }
  

// ================= ENUMS =================
enum MemberRole {
  LEADER = 0;
  MEMBER = 1;
}

enum InviteStatus {
  PENDING = 0;
  ACCEPTED = 1;
  REJECTED = 2;
}
// ================= MODELS =================
message Team {
  string id = 1;
  string name = 2;
  string leader_id = 3; // UserService dagi foydalanuvchi ID
  string event_id = 4;  // EventService dagi event ID
  bool is_ready = 5;
  string created_at = 6;
  string updated_at = 7;
}

message TeamMember {
  string id = 1;
  string team_id = 2;
  string user_id = 3; // UserService dagi foydalanuvchi ID
  MemberRole role = 4;
  string joined_at = 5;
}

// ================= REQUESTS =================

// --- Team CRUD ---
message CreateTeamRequest {
  string name = 1;
  string leader_id = 2;
  string event_id = 3;
}

message UpdateTeamRequest {
  string id = 1;
  string name = 2;
}

message GetTeamRequest {
  string team_id = 1;
}

message GetTeamsByEventRequest {
  string event_id = 1;
  int32 limit = 2;
  int32 page = 3;
}

message RemoveTeamMemberRequest {
  string team_id = 1;
  string user_id = 2;
}

// --- Invitations & Membership ---
message InviteMemberRequest {
  string team_id = 1;
  string inviter_id = 2; // kim yubordi (odatda leader)
  string invited_user_id = 3;
}

message RespondInviteRequest {
  string team_id = 1;
  string invited_user_id = 2;
  InviteStatus status = 3; // accepted/rejected
}

// ================= RESPONSES =================

message TeamList {
  repeated Team teams = 1;
  int32 total_count = 2;
}

message MemberList {
  repeated TeamMember members = 1;
  int32 total_count = 2;
}

message StatusResponse {
  int32 status = 1;
}